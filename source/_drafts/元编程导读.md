---
title: 元编程导读
tags:
  - meta program
date: 2022-09-13 16:25:25
---

## 什么是元编程(Metaprogramming)

一言以蔽之，元编程就是通过代码实现代码的一种方式。

在一般情况下，我们写的代码是直接对应的业务逻辑的。在一定程度上可以说是"所见即所得"的。这种代码是最符合直觉的。但是在某些情况下，正常的代码会显得不是非常高效。因此我们需要通过用代码来生成代码的方式来开发，这就是我们所说的元编程。

为了更好的理解元编程，我们来用一个非常简单的例子来说明一下元编程:

我们需要生成一些假的电话号码，用一般的代码可能会是这样实现的:

```typescript
const mobilePool = [
  "18012345678",
  "18112345678",
  "18812345678",
]

function getRandomMobileNum() {
  const len = mobilePool.length;
  return mobilePool[Math.floor(Math.random() * len)]
}
```

不论这个函数如何调用，都是从一个有限池(代码)中获取的某一项内容。但是实际上这种方式是比较受限的，因此以元编程的思想来说，我们可能会写出这样的代码:

```typescript
const mobilePrefix = [
  "180",
  "181",
  "188",
]

function getRandomMobileNum() {
  const len = mobilePrefix.length;
  return mobilePrefix[Math.floor(Math.random() * len)] + Math.random().toString().substr(2, 8);
}
```

即我们设定一个规则: 一个手机号是以 `180,181,188` 开始的, 然后后面跟上8位任意数字的，均视为一个合法的手机号。

其元信息为: `手机号是一个以固定3位开头加8位任意数字组合而成的11位数字`。

那么我们就可以根据这种固定的规则生成无限(相对手写)种可能的手机号码。

当然，相信大家都能写出代码。元编程也不是什么比较新鲜的东西，大家可能都写过类似的东西。元编程的思想对于我们来说也是一种必须掌握的编程能力。

## 元编程能做什么

当然上面的case过于简单，甚至可能都不能算得上元编程。元编程的概念在很多比较底层、基础的场景是非常常见的概念。

比较常见的场景是:

- 编程语言(比如typescript, coffee)
- 框架语言(比如jsx, vue-template等)
- 低代码/无代码平台
- 后端CRUD框架(比如graphql)
- 各类linter, formatter, parser, transformer, generator.
- ...

在平时开发中，我们常用的 `antd` 的 `Table/Column` 这种形式的代码也是一种元编程方式, 而 `Form` 则是普通的编程方式

## 如何实现元编程

<!-- TODO -->
