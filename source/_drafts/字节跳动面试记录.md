---
title: 字节跳动面试记录
tags:
  - 字节跳动
  - 面试
date: 2021-04-01 16:13:45
---

## 一面

关于项目:
- 抽象结构树
  - 如何根据一颗AST渲染出组件
- 富文本编辑器
  - 实现的难点

常规问题:
- webpack 打包细节
  - commonjs与esmodule是如何相互转换(这里不会)
- Task 与 Microtask 的区别, 以及时序

  详细说明可以见: https://html.spec.whatwg.org/multipage/webappapis.html#queuing-tasks

  简单的说就是每次执行`task`之前会把`microtask`都处理掉。在处理过程中加入的`microtask`也会按照顺序处理掉

- 闭包问题:
  ```javascript
  for(var i = 0; i < 5; i++) {
    setTimeout(() => {
      console.log(i)
    }, 1000)
  }
  ```
  结果是什么? (我回答了`5个4`, 其实是`5个5`..扶额)

  然后问如何让其输出0 1 2 3 4
  解法一:
  ```javascript
  for(var i = 0; i < 5; i++) {
    (function (_i) {
      setTimeout(() => {
        console.log(_i)
      }, 1000)
    })(i)
  }
  ```

  解法二:
  ```javascript
  for(let i = 0; i < 5; i++) {
    setTimeout(() => {
      console.log(i)
    }, 1000)
  }
  ```

  我没有说出解法二, 想了半天想出了一个解法三。。
  ```javascript
  for(var i = 0; i < 5; i++) {
    Promise.resolve(i).then(i => {
      setTimeout(() => {
        console.log(i)
      }, 1000)
    })
  }
  ```
- 中文数字转阿拉伯数字
  ```typescript
  // 五千三百万零五百零一

  const chineseNumMap = {
    一: 1,
    二: 2,
    三: 3,
    四: 4,
    五: 5,
    六: 6,
    七: 7,
    八: 8,
    九: 9,
  };

  const unitMap = {
    千: 1000,
    百: 100,
    十: 10,
  };

  function parseChineseNumWhenLowerThan10K(chineseNum: string) {
    let res = 0;
    let hasNum = false;
    let currentNum = 0;
    for (const s of chineseNum) {
      if (hasNum === false && chineseNumMap[s]) {
        res += chineseNumMap[s];
        hasNum = true;
        currentNum = chineseNumMap[s];
      } else if (hasNum === true && unitMap[s]) {
        res -= currentNum;
        res += currentNum * unitMap[s];
        hasNum = false;
        currentNum = 0;
      }
    }

    return res;
  }

  function chineseNumToInt(input: string): number {
    const chineseNumArr = input.split("万");
    let res = 0;

    res += parseChineseNumWhenLowerThan10K(chineseNumArr[0]);

    if (typeof chineseNumArr[1] === "string") {
      res *= 10000;
      res += parseChineseNumWhenLowerThan10K(chineseNumArr[1]);
    }

    return res;
  }

  console.log(chineseNumToInt("五千三百万零五百零一"));
  ```
